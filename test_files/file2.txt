This
code
has
been
refactored
for
testing
the
algorithm